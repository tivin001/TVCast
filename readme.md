
# TVCast - 基于DLNA的电视投屏工具

**TVCast** 是一个轻量级、高性能的 Windows 电视投屏工具。它基于标准 DLNA 协议，允许用户将电脑端的本地视频文件或实时桌面镜像一键投射到智能电视、投影仪或电视盒子上。

本项目特别针对旧设备和系统进行了优化，采用winform framework4.8框架，**最低支持 Windows 7 32位 (x86) 版本**，并采用了[**AntdUI**](https://github.com/AntdUI/AntdUI) 界面库，兼顾了极致的兼容性与美观的交互体验。
<img width="741" height="507" alt="截图" src="https://github.com/user-attachments/assets/3cf40974-446a-43ad-9cd0-2282323ddef7" />

---
**特别说明：** 本项目核心技术大部分为AI生成

## ✨ 核心特性

* **🚀 卓越的兼容性**
    * **多系统支持**：完美运行于 Windows 7(sp1) / 8 / 10 / 11（支持 32位 与 64位）。
    * **智能采集引擎**：在 Win8+ 系统优先使用 **DXGI (DirectX)** 高速采集；在 Win7 系统自动回退至 **GDI** 模式，确保老电脑也能流畅投屏。
* **🎬 双投屏模式**
    * **本地视频投屏**：支持 MP4、MKV、AVI 等格式。内置轻量级 HTTP 服务，支持电视端原生硬解码。
    * **桌面镜像 (直播)**：实时同步电脑画面。支持“包含声音”选项，实现音画同步（视频会卡顿）。
* **⚡ 硬件加速与优化**
    * **编码加速**：自动检测 NVIDIA 显卡并启用 **NVENC** 硬件加速，大幅降低 CPU 占用。
    * **极低延迟**：针对 DLNA 直播流进行了 `zerolatency` 调优，最大限度减少投屏时滞。

---

## 🛠️ 技术架构
* **设备发现 (`DLNADevice.cs`)**：通过 SSDP 协议实现局域网内 DLNA 渲染器的自动发现与状态解析。
* **流媒体引擎 (`VideoCaster.cs`)**：
    * **文件模式**：高性能 Socket 服务器，支持 HTTP Range 请求（允许在电视上拖动进度条）。
    * **镜像模式**：`屏幕采集 -> FFmpeg 实时编码 -> 命名管道 -> TCP 推流` 的流水线架构。
* **音频采集**：利用 **NAudio** 实现 WASAPI 环回采集，捕获系统播放出的声音。
* **关于ffmpeg**：需要手动下载并放到项目根目录，本人测试使用的是[7.0](https://github.com/BtbN/FFmpeg-Builds/releases)
---

## 📥 安装与使用

1.  **准备环境**：
    * 确保电脑与接收端（电视/盒子）处于同一局域网下。
2.  **开始投屏**：
    * 启动程序，在列表中点击“搜索设备”。
    * **视频模式**：选择本地文件后，点击“开始投屏”。
    * **桌面模式**：选中设备后，点击“投屏”即可。

---

## 🗂️ 文件结构说明

| 文件名 | 描述 |
| :--- | :--- |
| `DLNADevice.cs` | DLNA 协议核心实现，处理 SSDP 发现及 SOAP 控制指令。 |
| `VideoCaster.cs` | 核心调度器，管理本地 HTTP 服务器及 FFmpeg 编码进程。 |
| `frmMain.cs` | 基于 AntdUI 的主界面逻辑，处理 UI 更新及设备列表展示。 |

---

## ⚠️ 注意事项

* **防火墙**：首次运行请允许本程序及 FFmpeg 通过 Windows 防火墙，否则电视将无法访问流媒体。
* **音频内录**：桌面投屏如需声音，请确保电脑已安装声卡驱动并能正常发声。
---

## 🔗 关于本项目

* **开源地址**：[https://github.com/tivin001/TVCast](https://github.com/tivin001/TVCast)
* **交流反馈**：公众号：**非硬核开发**

## ⚖️ 开源协议 (License)

本项目采用 **GNU General Public License v3.0 (GPLv3)** 协议开源。

### 依赖组件说明
本项目使用了以下优秀的开源组件：

* **[AntdUI](https://github.com/AntdUI/AntdUI)**: 基于 **Apache License 2.0** 协议开源。
* 本项目在遵循 GPLv3 的前提下，完全保留并尊重第三方组件的原有协议。


有关协议的详细内容，请参阅项目根目录下的 [LICENSE](./LICENSE) 文件。
